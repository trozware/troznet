<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>
        Making a Mac Screen Saver ::
        TrozWare
      </title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="Having just completed the my first screen saver for Mac - the Time In Words Screen Saver, I thought I would share some of the experiences. I am using OS X Lion (10.7) and Xcode 4.3.2
The first thing is to create a new project in Xcode using the Screen Saver template:
Xcode sets up a project for you with everything you need for a screen saver module. Start editing the ScreenSaverView."
/>
<meta name="keywords" content="[Swift Apple macOS iOS Apple Watch]" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://troz.net/post/2012/making-a-mac-screen-saver/" />





 
<link rel="stylesheet" href="/css/style.css" />

<link rel="stylesheet" href="https://troz.net/style.css" />


<link
  rel="apple-touch-icon"
  sizes="180x180"
  href="/static/favs/apple-touch-icon.png"
/>
<link
  rel="icon"
  type="image/png"
  sizes="32x32"
  href="/static/favs/favicon-32x32.png"
/>
<link
  rel="icon"
  type="image/png"
  sizes="16x16"
  href="/static/favs/favicon-16x16.png"
/>
<link
  rel="manifest"
  href="/static/favs/site.webmanifest"
  crossorigin="use-credentials"
/>
<link
  rel="mask-icon"
  href="/static/favs/safari-pinned-tab.svg"
  color="#5bbad5"
/>
<link rel="shortcut icon" href="/static/favs/favicon.ico" />
<meta name="msapplication-TileColor" content="#da532c" />
<meta name="msapplication-config" content="/static/favs/browserconfig.xml" />
<meta name="theme-color" content="#ffffff" />


<link href="/fonts/Inter-Italic.woff2"
rel="preload" type="font/woff2" as="font" crossorigin=""> <link href="/fonts/Inter-Regular.woff2" rel="preload"
type="font/woff2" as="font" crossorigin=""> <link href="/fonts/Inter-Medium.woff2" rel="preload" type="font/woff2"
as="font" crossorigin=""> <link href="/fonts/Inter-MediumItalic.woff2" rel="preload"
type="font/woff2" as="font" crossorigin=""> <link href="/fonts/Inter-Bold.woff2" rel="preload" type="font/woff2"
as="font" crossorigin=""> <link href="/fonts/Inter-BoldItalic.woff2" rel="preload" type="font/woff2"
as="font" crossorigin="">


<meta property="og:title" content="Making a Mac Screen Saver" />
<meta property="og:description" content="Having just completed the my first screen saver for Mac - the Time In Words Screen Saver, I thought I would share some of the experiences. I am using OS X Lion (10.7) and Xcode 4.3.2
The first thing is to create a new project in Xcode using the Screen Saver template:
Xcode sets up a project for you with everything you need for a screen saver module. Start editing the ScreenSaverView." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://troz.net/post/2012/making-a-mac-screen-saver/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2012-05-09T00:00:00+00:00" />
<meta property="article:modified_time" content="2012-05-09T00:00:00+00:00" />






  </head>
  <body >
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a
  href="https://troz.net/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >TrozWare</span
    >
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/">Home</a></li>
        
      
        
          <li><a href="/apps/">Apps</a></li>
        
      
        
          <li><a href="/post/">Archives</a></li>
        
      
        
          <li><a href="/tags/">Tags</a></li>
        
      
        
          <li><a href="/contact/">Contact</a></li>
        
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/">Home</a></li>
      
    
      
        <li><a href="/apps/">Apps</a></li>
      
    
      
        <li><a href="/post/">Archives</a></li>
      
    
      
        <li><a href="/tags/">Tags</a></li>
      
    
      
        <li><a href="/contact/">Contact</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none" />
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg
  class="theme-toggler"
  width="24"
  height="24"
  viewBox="0 0 48 48"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"
  />
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        

<link rel="stylesheet" href="/css/header.css" />

<div class="post">
  <h2 class="post-title">
    <a href="https://troz.net/post/2012/making-a-mac-screen-saver/">Making a Mac Screen Saver</a>
  </h2>
  <div class="post-meta">
    <span class="post-date">
      09 May 2012
    </span>
    <span class="more-meta">- 934 words, </span>
    <span class="more-meta"> 5 minute read</span>
  </div>

  
  <span class="post-tags">
     #<a
      href="https://troz.net/tags/screen-saver"
      >screen saver</a
    >&nbsp;  #<a
      href="https://troz.net/tags/time-in-words"
      >time in words</a
    >&nbsp;  #<a
      href="https://troz.net/tags/mac"
      >mac</a
    >&nbsp; 
  </span>
   

  <div class="post-content"><p>Having just completed the my first screen saver for Mac - the <a href="/time-in-words-screen-saver-for-mac/" title="Time In Words Screen Saver for Mac">Time In Words
Screen Saver</a>, I thought I would share some of the experiences. I am using OS
X Lion (10.7) and Xcode 4.3.2</p>
<p>The first thing is to create a new project in Xcode using the Screen Saver
template:</p>
<p><a href="/images/ScreenSaverTemplate.png"><!-- raw HTML omitted --></a></p>
<p>Xcode sets up a project for you with everything you need for a screen saver
module. Start editing the ScreenSaverView.m file. The most important method here
is animateOneFrame.</p>
<p>This is called every time the animation time interval elapses. This interval is
set in <code>initWithFrame:isPreview:</code>. I have seen some debate online as to whether
the drawing should be done in the <code>animateOneFrame</code> method or in the <code>drawRect</code>
method. I chose to use <code>animateOneFrame</code> because they are both called when the
screen saver starts which can lead to an unpleasant flicker.</p>
<p>Now it is up to you to decide what to show in the <code>animateOneFrame</code> method. For
Time In Words, I assembled the data as a string, created a dictionary of text
attributes, calculated the location where I wanted to show the text and used
<code>drawAtPoint:withAttributes:</code> to display it.</p>
<p>There are a couple of important tricks when working out locations: firstly, you
will need to know the bounds of the screen saver area. This will vary depending
on the monitor, screen size or whether the screen saver is appearing in the
preview window in System Preferences. The screen saver view has a method that
does this work for you.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-objectivec" data-lang="objectivec"><span style="display:flex;"><span>NSRect viewBounds <span style="color:#f92672">=</span> [self bounds];
</span></span></code></pre></div><p>The next trick is that you are most likely going to need some random numbers.
Again, the screen saver framework supplies these to you in several forms. I used
<code>SSRandomFloatBetween</code> but there are others. Check the documentation.</p>
<p>I ran into an oddity in System Preferences that made testing a bit tedious. I
built the screen saver module and double-clicked on it to install into System
Preferences. That worked fine, but when I made some changes and repeated the
process, the original screen saver was still in place. I found that I had to
quit System Preferences each time. Deleting the old version of the screen saver
was not necessary, but quitting the System Prefs app was essential.</p>
<p>So that gives the basic screen saver module but with no options. Adding options
is not difficult, but as always, there are a few things that are not obvious on
first glance.</p>
<p>Add a xib file to your project: I used a window template. Then change the
window&rsquo;s class to NSPanel and configure it as shown:</p>
<!-- raw HTML omitted -->
<p>Set the File&rsquo;s Owner class to the class of your Screen Saver view. In your
ScreenSaverView.h file, declare a property for this new panel. e.g.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-objectivec" data-lang="objectivec"><span style="display:flex;"><span> <span style="color:#66d9ef">@property</span> (<span style="color:#66d9ef">assign</span>) <span style="color:#66d9ef">IBOutlet</span> NSPanel <span style="color:#f92672">*</span>optionsPanel;
</span></span></code></pre></div><p>@synthesize this in the ScreenSaverView.m file. In the xib file, connect the
panel to this outlet.</p>
<p>Now go back to ScreenSaverView.m and add the following code:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-objectivec" data-lang="objectivec"><span style="display:flex;"><span><span style="color:#f92672">*</span> (<span style="color:#66d9ef">BOOL</span>)hasConfigureSheet { <span style="color:#66d9ef">return</span> YES; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">*</span> (NSWindow <span style="color:#f92672">*</span>)configureSheet { <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>self.optionsPanel) { [NSBundle
</span></span><span style="display:flex;"><span>  loadNibNamed:<span style="color:#e6db74">@&#34;Options&#34;</span> owner:self]; } <span style="color:#66d9ef">return</span> self.optionsPanel; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">-</span> (<span style="color:#66d9ef">IBAction</span>)closeConfig:(<span style="color:#66d9ef">id</span>)sender { [[NSApplication sharedApplication]
</span></span><span style="display:flex;"><span>  endSheet:self.optionsPanel]; }
</span></span></code></pre></div><p>The <code>hasConfigureSheet</code> and <code>configureSheet</code> stubs are already there for you,
but you can replace them with these versions.</p>
<p>Go back to the xib file and drag in a button to close the options panel. Connect
it to the <code>closeConfig:</code> action.</p>
<p>Save everything, build, install in System Preferences and test. Firstly, the
&ldquo;Options&hellip;&rdquo; button should be enabled. Clicking it should open your panel as a
sheet, and when you click your button, the panel should close.</p>
<p>If that doesn&rsquo;t work, check the class assignments, the connections, the settings
for the NSPanel and the code in that order.</p>
<p>Once the panel is opening and closing as required, you need to add the ability
to store and retrieve the settings. Instead of using NSUserDefaults as you would
in a standard Mac app, there is a special class call ScreenSaverDefaults for
screen savers. It needs a unique module name, so I used the bundle identifier.
For my Time In Words screen saver, this is
&ldquo;net.troz.Time-In-Words-Screen-Saver&rdquo;. I defined a constant to hold this as a
string, so I could use it anywhere I needed.</p>
<p>In the <code>initWithFrame:isPreview:</code> method, I got a reference to the screen saver
defaults for my screen saver and registered the defaults. I am never very sure
about the need to do this, but it is supposed to be a good practice.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-objectivec" data-lang="objectivec"><span style="display:flex;"><span>ScreenSaverDefaults <span style="color:#f92672">*</span>defaults <span style="color:#f92672">=</span> [ScreenSaverDefaults defaultsForModuleWithName:kModuleName];
</span></span><span style="display:flex;"><span>[defaults registerDefaults:[NSDictionary dictionaryWithObjectsAndKeys:
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">@&#34;NO&#34;</span>, <span style="color:#e6db74">@&#34;UseAlternativeZone&#34;</span>, <span style="color:#e6db74">@&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">@&#34;AlternativeZoneName&#34;</span>, nil]
</span></span><span style="display:flex;"><span>];
</span></span></code></pre></div><p>Using them is exactly the same as using NSUserDefaults:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-objectivec" data-lang="objectivec"><span style="display:flex;"><span><span style="color:#75715e">// Reading
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>ScreenSaverDefaults <span style="color:#f92672">*</span>defaults <span style="color:#f92672">=</span> [ScreenSaverDefaults defaultsForModuleWithName:kModuleName];
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">BOOL</span> useAlternativeZone <span style="color:#f92672">=</span> [defaults boolForKey:<span style="color:#e6db74">@&#34;UseAlternativeZone&#34;</span>];
</span></span><span style="display:flex;"><span>NSString <span style="color:#f92672">*</span>alternativeZoneName <span style="color:#f92672">=</span> [defaults objectForKey:<span style="color:#e6db74">@&#34;AlternativeZoneName&#34;</span>];
</span></span></code></pre></div><p>&hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-objectivec" data-lang="objectivec"><span style="display:flex;"><span><span style="color:#75715e">// Writing
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>ScreenSaverDefaults <span style="color:#f92672">*</span>defaults <span style="color:#f92672">=</span> [ScreenSaverDefaults defaultsForModuleWithName:kModuleName]; [defaults setBool:useAlternative forKey:<span style="color:#e6db74">@&#34;UseAlternativeZone&#34;</span>];
</span></span><span style="display:flex;"><span>[defaults setObject:alternativeZoneName forKey:<span style="color:#e6db74">@&#34;AlternativeZoneName&#34;</span>];
</span></span><span style="display:flex;"><span>[defaults synchronize];
</span></span></code></pre></div><p>One last thing: if you want to distribute the screen saver, you will want to
create an archive, possibly code-signing with your Apple developer ID to allow
for Mountain Lion&rsquo;s up-coming Gatekeeper security system. I code-signed the
project and built an archive, but when I clicked &ldquo;Distribute&rdquo; in the Organizer,
the only appropriate options was &ldquo;Save Built Products&rdquo;. I selected this option
and ended up with a series of folders inside folders, with the screen saver
module in about the fifth folder down. I don&rsquo;t know why the module gets
distributed like this, but I pulled it out of the folders and it worked fine.</p>
<p>And that&rsquo;s about it. A lot of this stuff is online or in Apple&rsquo;s documentation,
but there are enough oddities to make it worthwhile gathering together all that
I learnt while making this screen saver.</p>
<p>Click this icon to download the screen saver:</p>
<p><a href="/screensaver/TimeInWords-ScreenSaver.zip"><!-- raw HTML omitted --></a></p>
</div>
  
  <div class="pagination">
    <div class="pagination__title">
      <span class="pagination__title-h">Read other posts</span>
      <hr />
    </div>
    <div class="pagination__buttons">
      
      <a class="btn next" href="https://troz.net/post/2012/pic-a-pod-2-0-4-for-mac/"
        >← Pic-a-POD 2.0.4 for Mac</a
      >
       
      <a class="btn previous" href="https://troz.net/post/2012/support-for-older-operating-systems/"
        >Support for older operating systems →</a
      >
      
    </div>
  </div>
  
</div>

      </div>

      
        <link rel="stylesheet" href="/css/footer.css" />

<footer class="footer">
  <div class="footer__inner">
    <div class="social_footer">
      <a id="email-Link" class="mailtoui" href="mailto:sarah@troz.net"
        ><img src="/icons/envelope.svg"
      /></a>
      
      <a rel="me" href="https://mastodon.social/@troz"
        ><img src="/icons/mastodon.png"
      /></a>

      <a href="https://linktr.ee/trozware"><img src="/icons/tree.svg" /></a>

      <a href="https://github.com/trozware"><img src="/icons/github.svg" /></a>

      <a href="https://stackoverflow.com/users/1082632"
        ><img src="/icons/stack-overflow.svg"
      /></a>

      <a href="https://troz.net/index.xml"><img src="/icons/rss.svg" /></a>
      <a href="https://troz.net/feed.json"><img src="/icons/json.png" /></a>

      <a href="https://dev.to/trozware">
        <img
          src="/icons/dev-badge.svg"
          alt="TrozWare's DEV Profile"
          style="height: 37px; margin-top: -3px"
          height="40"
          width="40"
        />
      </a>

      <a href="https://ko-fi.com/H2H3BU7SI" target="_blank"
        ><img
          height="36"
          style="border: 0px; height: 36px; width: unset"
          src="https://cdn.ko-fi.com/cdn/kofi1.png?v=3"
          border="0"
          alt="Buy Me a Coffee at ko-fi.com"
      /></a>
    </div>
  </div>

  <div class="footer__inner">
    <div class="copyright">
      
      <span>© 2012 - 2023 Sarah Reichelt</span>
      
      <span
        ><a href="http://gohugo.io">Hugo</a> theme created by
        <a href="https://twitter.com/panr">panr</a> 2018</span
      >
    </div>
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>


<script src="https://cdn.jsdelivr.net/npm/mailtoui@latest/dist/mailtoui-min.js"></script>


<script src="https://polyfill.io/v2/polyfill.min.js?features=IntersectionObserver"></script>
<script src="/quicklink.js"></script>

<script>
  window.addEventListener('load', () => {
    quicklink()
  })
</script>


      
    </div>

    
  </body>
</html>
