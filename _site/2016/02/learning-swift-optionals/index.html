<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Learning Swift - Optionals &#8211; TrozWare</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="macOS, iOS &amp;amp; watchOS Developer">
    <meta name="author" content="Sarah Reichelt">
    <meta name="keywords" content="">
    <link rel="canonical" href="http://localhost:4000/2016/02/learning-swift-optionals/">
    <link rel="alternate" type="application/rss+xml" title="RSS Feed for TrozWare" href="/feed.xml" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/pixyll.css" type="text/css">

    <!-- Fonts -->
    <link href='//fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Lato:900,300' rel='stylesheet' type='text/css'>
    
      <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
    

    <!-- MathJax -->
    

    <!-- Verifications -->
    

    <!-- Open Graph -->
    <!-- From: https://github.com/mmistakes/hpstr-jekyll-theme/blob/master/_includes/head.html -->
    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Learning Swift - Optionals">
    <meta property="og:description" content="macOS, iOS &amp;amp; watchOS Developer">
    <meta property="og:url" content="http://localhost:4000/2016/02/learning-swift-optionals/">
    <meta property="og:site_name" content="TrozWare">

    <!-- Twitter Card -->
    
        <meta name="twitter:card" content="summary" />
        
            <meta name="twitter:site" content="@trozware" />
        
        <meta name="twitter:title" content="" />
        <meta name="twitter:description" content="" />
        <meta name="twitter:url" content="/2016/02/learning-swift-optionals//2016/02/learning-swift-optionals/" />
        <meta name="twitter:image" content="" />
    

    <!-- Icons -->
    <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/icons/favicon-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/icons/favicon-160x160.png" sizes="160x160">
    <link rel="icon" type="image/png" href="/icons/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/icons/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="/icons/favicon-32x32.png" sizes="32x32">

    
    <script type="text/javascript">
       (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
       (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
       m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
       })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
       ga('create', 'UA-5511808-2', 'auto');
       ga('send', 'pageview');
    </script>
    
</head>

<body class="site">

	

  <div class="site-wrap">
    <header class="site-header px2 px-responsive">
  <div class="mt2 wrap">
    <div class="measure">
      <a href="http://localhost:4000" class="site-title">TrozWare</a>
      <nav class="site-nav">
        <a href="/applications/">Apps</a>
<a href="/tags/">Tags</a>
<a href="/archives/">Archives</a>
<a href="/contact/">Contact</a>

      </nav>
      <div class="clearfix"></div>
      
        <div class="social-icons">
  <div class="social-icons-right">
    
    
    
      <a class="fa fa-stack-overflow" href="https://stackoverflow.com/users/1082632"></a>
    
    <a class="fa fa-rss" href="/feed.xml"></a>
    
      <a class="fa fa-twitter" href="https://twitter.com/trozware"></a>
    
    
    
    
    
      <a class="fa fa-envelope" href="mailto:sarah@troz.net"></a>
    
    
    
    
  </div>
  <div class="right">
    
    
    
  </div>
</div>
<div class="clearfix"></div>

      
    </div>
  </div>
</header>


    <div class="post p2 p-responsive wrap" role="main">
      <div class="measure">
        


<div class="post-header mb2">
  <h1>Learning Swift - Optionals</h1>
  <span class="post-meta">12 Feb 2016</span><br>
  
  <span class="post-meta small">
  
    6 minute read
  
  </span>
</div>

<article class="post-content">
  <p>Today I plan to discuss optionals since they were a feature of Swift that I found difficult to grasp at first.</p>

<h3 id="what-is-an-optional-in-swift">What is an optional in Swift?</h3>

<p>An optional is a variable of a specified type that can also be nil.</p>

<h3 id="why-does-this-matter">Why does this matter?</h3>

<p>In Objective-C, any object type could be nil. If you declared a variable like this:</p>

<figure class="highlight"><pre><code class="language-objc" data-lang="objc"><span class="n">NSString</span> <span class="o">*</span><span class="n">myString</span><span class="p">;</span></code></pre></figure>

<p>then <code class="highlighter-rouge">myString</code> was set to nil by default.</p>

<p>But this could cause issues, especially as Objective-C does not complain if you send a message to nil. This could lead to bugs that were very difficult to track down.</p>

<p>The other big use for nil is when returning from a function which has found no appropriate data to return. The classic example is when looking for the index of an element in an array. What should be returned if the element is not found in the array?</p>

<p>Some languages return -1, Objective-C uses <code class="highlighter-rouge">NSNotFound</code>, but you have to know what each language is going to do. The more logical answer is nil. However if your function is expected to return an integer, then it cannot return nil because nil is not an integer.</p>

<p>This is where optionals come in: if the function is expected to return an optional integer, it can return with an integer with the index of the matching element, or it can return nil if the element was not found. This is much clearer and less prone to error.</p>

<hr />

<h2 id="how-does-swift-handle-optionals">How does Swift handle optionals?</h2>

<p>One of the first things that struck me about Swift was how clean the code looked, without so many non-alphanumeric characters scattered around. Gone were all the:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="o">*</span> <span class="p">;</span> <span class="p">[</span> <span class="p">]</span>
  </code></pre></figure>

<p>But instead, Swift code sprouted:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="o">!</span> <span class="p">?</span></code></pre></figure>

<p>What were these?</p>

<p><strong>The key to understanding optionals is to realise that when you declare an optional variable of a certain type, you are actually declaring a box that can hold a variable of that type or can hold nil.</strong></p>

<p>Once you grasp that concept, it all becomes much more obvious.</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="k">var</span> <span class="nv">optionalInteger</span><span class="p">:</span> <span class="kt">Int</span><span class="p">?</span></code></pre></figure>

<p>The ? indicates that this is an optional variable. It does not have to be initialised as it is already set to nil which is valid for an optional variable. Without the ? this would require initialisation as it would not be valid for it to be nil.</p>

<hr />

<h3 id="setting-an-optional">Setting an optional:</h3>

<p>Setting the value of an optional variable is just the same as any other variable:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="n">optionalInteger</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">optionalInteger</span> <span class="o">=</span> <span class="mi">42</span></code></pre></figure>

<hr />

<h3 id="getting-an-optional">Getting an optional:</h3>

<p>The difference arises when you need to get the data out of the optional variable in order to use it. This process is called un-wrapping and it means to get the variable value out of the ‘box’ it is stored it.</p>

<h4 id="the-most-obvious-way-is-to-use-">The most obvious way is to use !</h4>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="k">let</span> <span class="nv">newInteger</span> <span class="o">=</span> <span class="n">optionalInteger</span><span class="o">!</span></code></pre></figure>

<p><strong>DO NOT DO THIS!</strong></p>

<p>This is called forced-unwrapping and assumes that the optional variable is not nil. If the optional is nil, this will crash.
In Xcode, when you connect interface elements from your storyboard to a Swift file, Xcode will use ! like this:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">startButton</span><span class="p">:</span> <span class="kt">UIButton</span><span class="o">!</span></code></pre></figure>

<p>I have to assume Xcode knows what it is doing and the button will be available when needed, but you should not use ! - it is un-safe. By using it, you are vowing to the compiler that when it gets to that point, the optional value will not be nil. There are much better and safer ways of doing that.</p>

<hr />

<h4 id="use-if-let">Use ‘if let’:</h4>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">func</span> <span class="nf">doubleNumber</span><span class="p">(</span><span class="n">_</span> <span class="nv">optionalInteger</span><span class="p">:</span> <span class="kt">Int</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Int</span><span class="p">?</span> <span class="p">{</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">integerValue</span> <span class="o">=</span> <span class="n">optionalInteger</span> <span class="p">{</span>
        <span class="c1">// integerValue is not an optional</span>
        <span class="c1">// and is guaranteed to contain an Int</span>
        <span class="k">return</span> <span class="n">integerValue</span> <span class="o">*</span> <span class="mi">2</span>
    <span class="p">}</span>
    
    <span class="c1">// no integer found in the optional,</span>
    <span class="c1">// so return nil to indicate failure</span>
    <span class="k">return</span> <span class="kc">nil</span>
<span class="p">}</span></code></pre></figure>

<hr />

<h4 id="use-guard">Use guard:</h4>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">func</span> <span class="nf">doubleNumber</span><span class="p">(</span><span class="n">_</span> <span class="nv">optionalInteger</span><span class="p">:</span> <span class="kt">Int</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Int</span><span class="p">?</span> <span class="p">{</span>
    <span class="k">guard</span> <span class="k">let</span> <span class="nv">integerValue</span> <span class="o">=</span> <span class="n">optionalInteger</span> <span class="k">else</span> <span class="p">{</span>
        <span class="c1">// get out quickly, </span>
        <span class="c1">// returning nil to indicate failure</span>
        <span class="k">return</span> <span class="kc">nil</span>
    <span class="p">}</span>
    
    <span class="c1">// integerValue is not an optional </span>
    <span class="c1">// and is guaranteed to contain an Int</span>
    <span class="k">return</span> <span class="n">integerValue</span> <span class="o">*</span> <span class="mi">2</span>
<span class="p">}</span></code></pre></figure>

<p>These two alternatives (<code class="highlighter-rouge">if let</code> &amp; <code class="highlighter-rouge">guard</code>) do the same job but in opposite ways. In both cases, they perform a conditional un-wrapping that may or may not give a valid result. <code class="highlighter-rouge">if let</code> checks if it is OK to proceed. <code class="highlighter-rouge">guard</code> checks to see if it is NOT OK to proceed. Which you use is really a matter of personal preference and working out what is more logical in each case.</p>

<p>The <code class="highlighter-rouge">guard</code> statement is really good for checking data early in a process and making a quick exit it something is wrong.
The <code class="highlighter-rouge">if let</code> construct encloses your success code inside a block and can sometimes leave the failure code a long way from the check which can make it less obvious. The other potential issue with <code class="highlighter-rouge">if let</code> is the “pyramid of doom” common in early Swift code as demonstrated in this rather contrived example:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">func</span> <span class="nf">isValidAddressBookEntry</span><span class="p">(</span>
    <span class="nv">firstName</span><span class="p">:</span> <span class="kt">String</span><span class="p">?,</span>
    <span class="nv">lastName</span><span class="p">:</span> <span class="kt">String</span><span class="p">?,</span>
    <span class="nv">emailAddress</span><span class="p">:</span> <span class="kt">String</span><span class="p">?,</span>
    <span class="nv">phoneNumber</span><span class="p">:</span> <span class="kt">String</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
    
        <span class="k">if</span> <span class="k">let</span> <span class="nv">validFirstName</span> <span class="o">=</span> <span class="n">firstName</span> <span class="p">{</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">validLastName</span> <span class="o">=</span> <span class="n">lastName</span> <span class="p">{</span>
                <span class="k">if</span> <span class="k">let</span> <span class="nv">validEmail</span> <span class="o">=</span> <span class="n">emailAddress</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="k">let</span> <span class="nv">validPhone</span> <span class="o">=</span> <span class="n">phoneNumber</span> <span class="p">{</span>
                        <span class="k">return</span> <span class="kc">true</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">false</span>
<span class="p">}</span></code></pre></figure>

<p>Thankfully, Swift 2 allows us to chain both <code class="highlighter-rouge">if let</code> and <code class="highlighter-rouge">guard</code> statements. Here is the previous example re-factored for Swift 2:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">func</span> <span class="nf">isValidAddressBookEntry</span><span class="p">(</span>
    <span class="nv">firstName</span><span class="p">:</span> <span class="kt">String</span><span class="p">?,</span>
    <span class="nv">lastName</span><span class="p">:</span> <span class="kt">String</span><span class="p">?,</span>
    <span class="nv">emailAddress</span><span class="p">:</span> <span class="kt">String</span><span class="p">?,</span>
    <span class="nv">phoneNumber</span><span class="p">:</span> <span class="kt">String</span><span class="p">?)</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
    
        <span class="k">if</span> <span class="k">let</span>
            <span class="nv">validFirstName</span> <span class="o">=</span> <span class="n">firstName</span><span class="p">,</span>
            <span class="n">validLastName</span> <span class="o">=</span> <span class="n">lastName</span><span class="p">,</span>
            <span class="n">validEmail</span> <span class="o">=</span> <span class="n">emailAddress</span><span class="p">,</span>
            <span class="n">validPhone</span> <span class="o">=</span> <span class="n">phoneNumber</span> <span class="p">{</span>
                <span class="k">return</span> <span class="kc">true</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">false</span>
<span class="p">}</span></code></pre></figure>

<hr />

<h4 id="use-optional-chaining">Use optional chaining:</h4>

<p>The final way to deal with optionals safely is to use optional chaining:</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">struct</span> <span class="kt">SocialMediaAccounts</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">facebook</span><span class="p">:</span> <span class="kt">Person</span><span class="p">?</span>
    <span class="k">var</span> <span class="nv">twitter</span><span class="p">:</span> <span class="kt">Person</span><span class="p">?</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">Person</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">firstName</span><span class="p">:</span> <span class="kt">String</span><span class="p">?</span>
    <span class="k">var</span> <span class="nv">lastName</span><span class="p">:</span> <span class="kt">String</span><span class="p">?</span>
    <span class="k">var</span> <span class="nv">handle</span><span class="p">:</span> <span class="kt">String</span><span class="p">?</span>
<span class="p">}</span>

<span class="k">var</span> <span class="nv">socialMedia</span><span class="p">:</span> <span class="kt">SocialMediaAccounts</span><span class="p">?</span>
<span class="n">socialMedia</span> <span class="o">=</span> <span class="kt">SocialMediaAccounts</span><span class="p">()</span>
<span class="k">var</span> <span class="nv">twitterAccount</span> <span class="o">=</span> <span class="kt">Person</span><span class="p">()</span>

<span class="n">socialMedia</span><span class="p">?</span><span class="o">.</span><span class="n">twitter</span> <span class="o">=</span> <span class="n">twitterAccount</span>
<span class="k">let</span> <span class="nv">twitterHandle</span> <span class="o">=</span> <span class="n">socialMedia</span><span class="p">?</span><span class="o">.</span><span class="n">twitter</span><span class="p">?</span><span class="o">.</span><span class="n">handle</span></code></pre></figure>

<p>In this example, we have defined a <code class="highlighter-rouge">SocialMediaAccounts</code> struct that holds optional <code class="highlighter-rouge">Person</code> structs for the various social media outlets. The <code class="highlighter-rouge">socialMedia</code> variable is defined as an optional and then created. A <code class="highlighter-rouge">twitterAccount</code> variable of type <code class="highlighter-rouge">Person</code> is also created but contains no data at the moment.</p>

<p>When assigning the <code class="highlighter-rouge">twitterAccount</code> to the <code class="highlighter-rouge">socialMedia.twitter</code> property, a ? is inserted which checks to see that <code class="highlighter-rouge">socialMedia</code> is not nil. If it is nil, then execution of that line stops at the ? and nothing bad will happen.</p>

<p>In the same way, when trying to read back the twitter handle, we chained together 2 optionals with ?’s. If either <code class="highlighter-rouge">socialMedia</code> or <code class="highlighter-rouge">socialMedia.twitter</code> is nil, that line will not complete. Again this is perfectly safe and the app will not crash.</p>

<hr />

<p>All the examples in this article are available in a <a href="https://github.com/trozware/optionals">Swift playground</a> which has been updated to Swift 3 syntax.</p>


</article>

<br>
<!-- <a href="/tags/">Tags</a>: swift, learning swift, and optionals -->
Tags: 

    <a href="/tags/#swift">swift</a>&nbsp;&nbsp;

    <a href="/tags/#learning swift">learning swift</a>&nbsp;&nbsp;

    <a href="/tags/#optionals">optionals</a>&nbsp;&nbsp;

<hr>






  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname  = 'trozware';
    var disqus_identifier = '/2016/02/learning-swift-optionals';
    var disqus_title      = 'Learning Swift - Optionals';

    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>






      </div>
    </div>
  </div>

  <footer class="center">
  <div class="measure">
    <small>
      Theme crafted with &lt;3 by <a href="http://johnotander.com">John Otander</a> (<a href="https://twitter.com/4lpine">@4lpine</a>).<br>
      &lt;/&gt; available on <a href="https://github.com/johnotander/pixyll">Github</a>.
    </small>
  </div>
</footer>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-5511808-2', 'auto');
ga('send', 'pageview');

</script>


</body>
</html>
